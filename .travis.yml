language: python
python: 
  - "2.7"
branches:
  only:
    - travis
    - docker
env:
  global:
    - DBHOST=localhost
  matrix:
    - TEST=go
    - TEST=nodejs
before_install:
  - echo hello world 
  - sudo apt-get update
  - sudo apt-get install openssh-server
  # Run as travis use (who has passwordless sudo)
  - ssh-keygen -f /home/travis/.ssh/id_rsa -N '' -t rsa  
  - cat /home/travis/.ssh/id_rsa.pub > /home/travis/.ssh/authorized_keys
  - chmod 600 /home/travis/.ssh/authorized_keys
install:
  - pip install docker-py
  - pip install coveralls
before_script:
  - echo about to script
script: 
  - coverage run --omit installs,results toolset/run-tests.py -s localhost -c localhost -d localhost -u travis -i /home/travis/.ssh/id_rsa --database-user travis --database-host localhost --database-identity-file /home/travis/.ssh/id_rsa --mode verify --log DEBUG --install server --type json --test $TEST
after_success:
  - coveralls
after_failure:
  - echo Nien
after_script:
  - echo finishing up
